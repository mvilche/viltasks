{{set . "title" "Home"}}
{{template "header.html" .}}

<div class="jumbotron">
{{if not .t}}
<h3>No se encontraron tareas en el sistema.</h3>
<form action=/task/create method="GET">
<button type="submit" class="btn btn-primary">Crear nuevo task</button>
</form>
{{else}}
<div class="container">
<form action=/task/create method="GET">
<button type="submit" class="btn btn-primary">Crear nuevo task</button>
</form>
<br>
<br>
<table class="table table-hover">
  <thead>
    <tr class="table-dark">
      <th scope="row">Nombre</th>
      <th scope="row">Descripción</th>
      <th scope="row">Comando</th>
      <th scope="row">Tiempo</th>
      <th scope="row">Zona horaria</th>
      <th scope="row">Notificar ejecución</th>
      <th scope="row">Eliminar</th>
    </tr>
  </thead>
  <tbody>
    {{range $index, $element := .t}}
    <form action="/task/delete" method="GET">
    <input id="id" name="id" type="hidden" value="{{$element.CronId}}">
    <tr class="table-light">
      <td>{{$element.Name}}</td>
      <td>{{$element.Description}}</td>
      <td>{{$element.Command}}</td>
      <td>{{$element.Time}}</td>
      <td>{{$element.Timezone}}</td>
      {{ if not $element.Notification_email }}
      <td>Desactivado</td>
      {{else}}
      <td>{{$element.Notification_email}}</td>
      {{end}}
      
      <td><button type="button" data-toggle="modal" data-target="#myModal" class="btn btn-danger btn-sm">x</button></td>
    </tr>
    <div class="modal" id="myModal">
      <div class="modal-dialog" role="dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title">Confirmar cambios</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <p>¿Está seguro de eliminar la tarea seleccionada?</p>
            <p>La acción eliminará completamente la tarea del sistema</p>
          </div>
          <div class="modal-footer">
            <button type="submit" class="btn btn-danger">Eliminar</button>
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancelar</button>
          </div>
        </div>
      </div>
    </div>
  </form>
    {{end}}
  </tbody>
</table>
</div>
{{end}} 
</div>
{{template "footer.html" .}}
